(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{32:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),s=n(23),o=n.n(s),c=n(9),r=(n(32),n(26)),l=n(4),u=n(2),d=n(24),h=n(27),m=n(0),j=["component"],b=function(e){var t=e.component,n=Object(h.a)(e,j);return Object(m.jsx)(u.b,{children:function(){return n.loggedIn?Object(m.jsx)(t,Object(d.a)({},n)):Object(m.jsx)(u.a,{to:"/signin"})}})},p=n.p+"static/media/logo.4e8e0a1d.svg";var f=function(e){var t=Object(u.h)(),n=Object(u.g)(),a="",i=null;return"/signin"===t.pathname?(a="Sign Up",i=function(){n.push("/signup")}):"/signup"===t.pathname?(a="Log in",i=function(){n.push("/signin")}):"/"===t.pathname&&(a="Sign Out",i=e.handleSignOut),Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("img",{src:p,alt:"Around U.S.",className:"logo"}),Object(m.jsx)("button",{onClick:i,className:"header__link",children:a})]})},O=n(11),_=n(12),g=n(13),v=n(8),x=n(18),C=n(17),k=function(e){Object(x.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(_.a)(this,n),(a=t.call(this,e)).state={email:"",password:""},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a}return Object(g.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.email&&this.state.password&&this.props.handleAuthorize(this.state.email,this.state.password)}},{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(O.a)({},n,a))}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"login",children:[Object(m.jsx)("p",{className:"login__heading",children:"Log in"}),Object(m.jsxs)("form",{onSubmit:this.handleSubmit,className:"login__form",children:[Object(m.jsx)("input",{required:!0,id:"email",name:"email",type:"text",placeholder:"Email",value:this.state.username,onChange:this.handleChange}),Object(m.jsx)("input",{required:!0,id:"password",name:"password",type:"password",placeholder:"Password",value:this.state.password,onChange:this.handleChange}),Object(m.jsx)("div",{className:"login__button-container",children:Object(m.jsx)("button",{type:"submit",onSubmit:this.handleSubmit,className:"login__button",children:"Log in"})})]}),Object(m.jsx)("p",{className:"login__text",children:"Not a member yet? Sign up here!"})]})}}]),n}(i.a.Component),N=Object(u.i)(k),y=function(e){Object(x.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(_.a)(this,n),(a=t.call(this,e)).state={email:"",password:"",confirmPassword:""},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a}return Object(g.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.password===this.state.confirmPassword&&this.props.handleRegister(this.state.email,this.state.password)}},{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(O.a)({},n,a))}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"login",children:[Object(m.jsx)("p",{className:"login__heading",children:"Sign up"}),Object(m.jsxs)("form",{onSubmit:this.handleSubmit,className:"login__form",children:[Object(m.jsx)("input",{required:!0,id:"email",name:"email",type:"text",placeholder:"Email",value:this.state.email,onChange:this.handleChange}),Object(m.jsx)("input",{required:!0,id:"password",name:"password",type:"password",placeholder:"Password",value:this.state.password,onChange:this.handleChange}),Object(m.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:this.state.confirmPassword,onChange:this.handleChange,placeholder:"Confirm Password",required:!0}),Object(m.jsx)("div",{className:"login__button-container",children:Object(m.jsx)("button",{type:"submit",onSubmit:this.handleSubmit,className:"login__button",children:"Sign Up"})})]}),Object(m.jsx)("p",{className:"login__text",children:"Already a member? Log in here!"})]})}}]),n}(i.a.Component),S=Object(u.i)(y),w="https://api.assel.students.nomoreparties.site",U=i.a.createContext();var L=function(e){var t=i.a.useContext(U),n=e.card.owner===t._id,a="card__delete-button ".concat(n?"":"card__delete-button_disabled"),s=e.card.likes.some((function(e){return e===t._id})),o="card__like-button ".concat(s?"card__like-button_active":"card__like-button_disabled");return Object(m.jsxs)("div",{className:"card",children:[Object(m.jsx)("button",{"aria-label":"delete",type:"button",className:a,onClick:function(){e.onCardDelete(e.card)}}),Object(m.jsx)("img",{src:e.card.link,alt:e.card.name,className:"card__image",onClick:function(){e.onCardClick(e.card)}}),Object(m.jsx)("h2",{className:"card__text",children:e.card.name}),Object(m.jsxs)("div",{className:"card__like",children:[Object(m.jsx)("button",{"aria-label":"Like",type:"button",className:o,onClick:function(){e.onCardLike(e.card)}}),Object(m.jsx)("div",{className:"card__like-overlay"}),Object(m.jsx)("p",{className:"card__like-count",children:e.card.likes.length})]})]})};var T=function(e){var t=i.a.useContext(U);return Object(m.jsxs)("main",{className:"content",children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsxs)("div",{className:"profile__avatar-container",children:[Object(m.jsx)("img",{src:t.avatar,alt:"portrait of user",className:"profile__avatar"}),Object(m.jsx)("div",{className:"profile__avatar-edit-container",children:Object(m.jsx)("button",{"aria-label":"Edit",type:"button",className:"profile__avatar-edit",onClick:e.onEditAvatar})})]}),Object(m.jsxs)("div",{className:"profile__info",children:[Object(m.jsx)("h1",{className:"profile__name",children:t.name}),Object(m.jsx)("button",{"aria-label":"Edit",type:"button",className:"profile__edit-button",onClick:e.onEditProfile}),Object(m.jsx)("p",{className:"profile__description",children:t.about})]}),Object(m.jsx)("button",{"aria-label":"Add",type:"button",className:"profile__add-button",onClick:e.onAddPlace})]}),Object(m.jsx)("section",{className:"cards",children:e.cards.map((function(t){return Object(m.jsx)(L,{card:t,onCardClick:e.onCardClick,onCardLike:e.handleCardLike,onCardDelete:e.handleCardDelete},t._id)}))})]})};var P=function(){return Object(m.jsx)("footer",{className:"footer",children:Object(m.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Around The U.S."})})};var A=function(e){var t=0!==Object.keys(e.card).length?"modal_opened":"";return Object(m.jsx)("div",{className:"modal modal-figure ".concat(t),children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("figure",{className:"modal__figure",children:[Object(m.jsx)("img",{src:e.card.link,alt:e.card.name,className:"modal__image"}),Object(m.jsx)("figcaption",{className:"modal__image-caption",children:e.card.name})]}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})},E=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(_.a)(this,e),this.baseUrl=n,this.headers=a}return Object(g.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getUserInfo",value:function(e){return fetch(this.baseUrl+"/users/me",{method:"GET",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"updateUserInfo",value:function(e,t){var n=t.name,a=t.about;return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({name:n,about:a})}).then(this._checkResponse)}},{key:"updateUserAvatar",value:function(e,t){return fetch(this.baseUrl+"/users/me/avatar",{method:"PATCH",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then(this._checkResponse)}},{key:"getInitialCards",value:function(e){return fetch(this.baseUrl+"/cards",{method:"GET",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"getAppInfo",value:function(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}},{key:"postCard",value:function(e,t){return fetch(this.baseUrl+"/cards",{method:"POST",body:JSON.stringify({name:t.name,link:t.link}),headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"deleteCard",value:function(e,t){return fetch(this.baseUrl+"/cards/"+t,{method:"DELETE",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"addLike",value:function(e,t){return fetch(this.baseUrl+"/cards/likes/"+t,{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"removeLike",value:function(e,t){return fetch(this.baseUrl+"/cards/likes/"+t,{method:"DELETE",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then(this._checkResponse)}}]),e}())({baseUrl:"https://api.assel.students.nomoreparties.site",headers:{"Content-Type":"application/json"}});var I=function(e){var t="modal modal-".concat(e.name);return t+=e.isOpen?" modal_opened":"",Object(m.jsx)("div",{className:t,children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("form",{className:"form",name:"edit-profile",onSubmit:e.onSubmit,children:[Object(m.jsx)("h2",{className:"form__heading",children:e.title}),e.children,Object(m.jsx)("button",{"aria-label":"Submit",type:"submit",className:"form__save-button",children:"Save"})]}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})};var D=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],o=n[1],c=Object(a.useState)(""),r=Object(l.a)(c,2),u=r[0],d=r[1],h=i.a.useContext(U);return i.a.useEffect((function(){o(h.name||""),d(h.about||"")}),[h]),Object(m.jsxs)(I,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:s,about:u})},title:"Edit profile",name:"edit",children:[Object(m.jsx)("input",{value:s,onChange:function(e){o(e.target.value)},id:"name-input",type:"text",name:"name",className:"form__input form__input_type_name",minLength:"2",maxLength:"40",placeholder:"Name",required:!0}),Object(m.jsx)("span",{id:"name-input-error",className:"form__input-error"}),Object(m.jsx)("input",{value:u,onChange:function(e){d(e.target.value)},id:"description-input",type:"text",name:"about",className:"form__input form__input_type_description",minLength:"2",maxLength:"200",placeholder:"About",required:!0}),Object(m.jsx)("span",{id:"description-input-error",className:"form__input-error"})]})};var R=function(e){var t=Object(a.useRef)("");return Object(m.jsxs)(I,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateUserAvatar(t.current.value),t.current.value=""},title:"Change profile picture",name:"avatar-edit",children:[Object(m.jsx)("input",{ref:t,id:"description-input",type:"url",name:"avatar-url",className:"form__input form__input_type_description",minLength:"2",maxLength:"200",placeholder:"url",required:!0}),Object(m.jsx)("span",{id:"description-input-error",className:"form__input-error"})]})};var z=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),i=n[0],s=n[1],o=Object(a.useState)(""),c=Object(l.a)(o,2),r=c[0],u=c[1];return Object(m.jsxs)(I,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:i,link:r}),s(""),u("")},title:"New place",name:"add",children:[Object(m.jsx)("input",{value:i,onChange:function(e){s(e.target.value)},id:"name-input",type:"text",name:"name",className:"form__input form__input_type_name",minLength:"2",maxLength:"40",placeholder:"Title",required:!0}),Object(m.jsx)("span",{id:"name-input-error",className:"form__input-error"}),Object(m.jsx)("input",{value:r,onChange:function(e){u(e.target.value)},id:"description-input",type:"url",name:"about",className:"form__input form__input_type_description",minLength:"2",maxLength:"200",placeholder:"Image link",required:!0}),Object(m.jsx)("span",{id:"description-input-error",className:"form__input-error"})]})};var B=function(e){var t=e.isOpen?"modal_opened":"";return Object(m.jsx)("div",{className:"modal modal-figure ".concat(t),children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("form",{className:"form form-delete-confirm",name:"delete-confirm",children:[Object(m.jsx)("h2",{className:"form__heading",children:"Are you sure?"}),Object(m.jsx)("button",{"aria-label":"delete-confirm",type:"submit",className:"form__save-button",onClick:function(t){t.preventDefault(),e.handleCardDeleteConfirm()},children:"Yes"})]}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})};var q=function(e){return Object(m.jsx)("div",{className:"modal modal_opened",children:Object(m.jsxs)("div",{className:"modal__container infotooltip",children:[Object(m.jsx)("img",{alt:"error status",src:e.imgSrc,className:"infotooltip__img"}),Object(m.jsx)("h2",{className:"infotooltip__heading",children:e.message}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})},M=n.p+"static/media/success.1b6082f8.svg",J=n.p+"static/media/union.7c6a020b.svg";var F=Object(u.i)((function(){var e,t,n=Object(a.useState)({}),i=Object(l.a)(n,2),s=i[0],o=i[1],c=Object(a.useState)(!1),d=Object(l.a)(c,2),h=d[0],j=d[1],p=Object(a.useState)(!1),O=Object(l.a)(p,2),_=O[0],g=O[1],v=Object(a.useState)(!1),x=Object(l.a)(v,2),C=x[0],k=x[1],y=Object(a.useState)({}),L=Object(l.a)(y,2),I=L[0],F=L[1],G=Object(a.useState)({isOpen:!1,id:""}),H=Object(l.a)(G,2),Y=H[0],K=H[1],Q=Object(a.useState)([]),V=Object(l.a)(Q,2),W=V[0],X=V[1],Z=Object(a.useState)(!1),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=Object(u.g)(),ae=Object(a.useState)({registered:!1,showModal:!1}),ie=Object(l.a)(ae,2),se=ie[0],oe=ie[1],ce=Object(a.useState)((function(){return localStorage.getItem("jwt")})),re=Object(l.a)(ce,2),le=re[0],ue=re[1];function de(){k(!1),j(!1),g(!1),K({isOpen:!1,id:null}),F({})}return Object(a.useEffect)((function(){le&&function(e){return fetch("".concat(w,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(le).then((function(){te(!0)})).then((function(){ne.push("/")}))}),[ne,le]),Object(a.useEffect)((function(){E.getUserInfo(le).then((function(e){o(e.user)})).catch((function(e){console.log(e)}))}),[le]),Object(a.useEffect)((function(){E.getInitialCards(le).then((function(e){X(e)})).catch((function(e){console.log(e)}))}),[le]),se.showModal&&se.registered?(e="Success! You have now been registered.",t=M):se.showModal&&(e="Oops, something went wrong! Please try again.",t=J),Object(m.jsx)(U.Provider,{value:s,children:Object(m.jsxs)("div",{className:"page",children:[Object(m.jsx)(f,{handleSignOut:function(){ue(""),localStorage.removeItem("jwt"),te(!1),ne.push("/signin")}}),Object(m.jsxs)(u.d,{children:[Object(m.jsxs)(u.b,{path:"/signup",children:[Object(m.jsx)(S,{handleRegister:function(e,t){(function(e,t){return fetch("".concat(w,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){oe(e?{registered:!0,showModal:!0}:{showModal:!0})}))}}),se.showModal&&Object(m.jsx)(q,{onClose:function(){se.showModal&&se.registered?(oe({showModal:!1}),ne.push("/signin")):oe({showModal:!1})},message:e,imgSrc:t})]}),Object(m.jsx)(u.b,{path:"/signin",children:Object(m.jsx)(N,{handleAuthorize:function(e,t){(function(e,t){return fetch("".concat(w,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),console.log(e.token),e})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){e.token&&(te(!0),ue(e.token),ne.push("/"))})).catch((function(e){return console.log(e)}))}})}),Object(m.jsx)(b,{path:"/",loggedIn:ee,onEditProfile:function(){j(!0)},onAddPlace:function(){g(!0)},onEditAvatar:function(){k(!0)},onCardClick:function(e){var t=e.name,n=e.link;F({name:t,link:n})},cards:W,handleCardLike:function(e){e.likes.some((function(e){return e===s._id}))?E.removeLike(le,e._id).then((function(e){X(W.map((function(t){return t._id===e._id?e:t})))})).catch((function(e){console.log(e)})):E.addLike(le,e._id).then((function(e){X(W.map((function(t){return t._id===e._id?e:t})))})).catch((function(e){console.log(e)}))},handleCardDelete:function(e){K({isOpen:!0,id:e._id})},component:T})]}),Object(m.jsx)(P,{}),Object(m.jsx)(D,{isOpen:h,onClose:de,onUpdateUser:function(e){var t=e.name,n=e.about;E.updateUserInfo(le,{name:t,about:n}).then((function(e){o(e.user),de()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(R,{isOpen:C,onClose:de,onUpdateUserAvatar:function(e){E.updateUserAvatar(le,e).then((function(e){o(e.user),de()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(z,{isOpen:_,onClose:de,onAddPlace:function(e){E.postCard(le,e).then((function(e){X([e].concat(Object(r.a)(W))),de()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(A,{card:I,onClose:de}),Object(m.jsx)(B,{isOpen:Y.isOpen,onClose:de,handleCardDeleteConfirm:function(){Y.isOpen&&Y.id&&E.deleteCard(le,Y.id).then((function(){X(W.filter((function(e){return e._id!==Y.id}))),de()})).catch((function(e){console.log(e)}))}})]})})})),G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),i(e),s(e),o(e)}))};o.a.render(Object(m.jsx)(i.a.StrictMode,{children:Object(m.jsx)(c.a,{children:Object(m.jsx)(F,{})})}),document.getElementById("root")),G()}},[[42,1,2]]]);
//# sourceMappingURL=main.7d630dd7.chunk.js.map