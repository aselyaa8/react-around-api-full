(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{32:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),i=n(23),c=n.n(i),o=n(9),r=(n(32),n(26)),l=n(4),d=n(2),u=n(24),h=n(27),m=n(0),b=["component"],j=function(e){var t=e.component,n=Object(h.a)(e,b);return Object(m.jsx)(d.b,{children:function(){return n.loggedIn?Object(m.jsx)(t,Object(u.a)({},n)):Object(m.jsx)(d.a,{to:"/signin"})}})},p=n.p+"static/media/logo.4e8e0a1d.svg";var f=function(e){var t=Object(d.h)(),n=Object(d.g)(),a="",s=null;return"/signin"===t.pathname?(a="Sign Up",s=function(){n.push("/signup")}):"/signup"===t.pathname?(a="Log in",s=function(){n.push("/signin")}):"/"===t.pathname&&(a="Sign Out",s=e.handleSignOut),Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("img",{src:p,alt:"Around U.S.",className:"logo"}),Object(m.jsx)("button",{onClick:s,className:"header__link",children:a})]})},O=n(11),_=n(12),g=n(13),v=n(8),x=n(18),C=n(17),k=function(e){Object(x.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(_.a)(this,n),(a=t.call(this,e)).state={email:"",password:""},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a}return Object(g.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.email&&this.state.password&&this.props.handleAuthorize(this.state.email,this.state.password)}},{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(O.a)({},n,a))}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"login",children:[Object(m.jsx)("p",{className:"login__heading",children:"Log in"}),Object(m.jsxs)("form",{onSubmit:this.handleSubmit,className:"login__form",children:[Object(m.jsx)("input",{required:!0,id:"email",name:"email",type:"text",placeholder:"Email",value:this.state.username,onChange:this.handleChange}),Object(m.jsx)("input",{required:!0,id:"password",name:"password",type:"password",placeholder:"Password",value:this.state.password,onChange:this.handleChange}),Object(m.jsx)("div",{className:"login__button-container",children:Object(m.jsx)("button",{type:"submit",onSubmit:this.handleSubmit,className:"login__button",children:"Log in"})})]}),Object(m.jsx)("p",{className:"login__text",children:"Not a member yet? Sign up here!"})]})}}]),n}(s.a.Component),N=Object(d.i)(k),y=function(e){Object(x.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(_.a)(this,n),(a=t.call(this,e)).state={email:"",password:"",confirmPassword:""},a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a}return Object(g.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.state.password===this.state.confirmPassword&&this.props.handleRegister(this.state.email,this.state.password)}},{key:"handleChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(O.a)({},n,a))}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"login",children:[Object(m.jsx)("p",{className:"login__heading",children:"Sign up"}),Object(m.jsxs)("form",{onSubmit:this.handleSubmit,className:"login__form",children:[Object(m.jsx)("input",{required:!0,id:"email",name:"email",type:"text",placeholder:"Email",value:this.state.email,onChange:this.handleChange}),Object(m.jsx)("input",{required:!0,id:"password",name:"password",type:"password",placeholder:"Password",value:this.state.password,onChange:this.handleChange}),Object(m.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:this.state.confirmPassword,onChange:this.handleChange,placeholder:"Confirm Password",required:!0}),Object(m.jsx)("div",{className:"login__button-container",children:Object(m.jsx)("button",{type:"submit",onSubmit:this.handleSubmit,className:"login__button",children:"Sign Up"})})]}),Object(m.jsx)("p",{className:"login__text",children:"Already a member? Log in here!"})]})}}]),n}(s.a.Component),S=Object(d.i)(y),w="http://localhost:3000",U=s.a.createContext();var L=function(e){var t=s.a.useContext(U),n=e.card.owner._id===t._id,a="card__delete-button ".concat(n?"":"card__delete-button_disabled"),i=e.card.likes.some((function(e){return e._id===t._id})),c="card__like-button ".concat(i?"card__like-button_active":"card__like-button_disabled");return Object(m.jsxs)("div",{className:"card",children:[Object(m.jsx)("button",{"aria-label":"delete",type:"button",className:a,onClick:function(){e.onCardDelete(e.card)}}),Object(m.jsx)("img",{src:e.card.link,alt:e.card.name,className:"card__image",onClick:function(){e.onCardClick(e.card)}}),Object(m.jsx)("h2",{className:"card__text",children:e.card.name}),Object(m.jsxs)("div",{className:"card__like",children:[Object(m.jsx)("button",{"aria-label":"Like",type:"button",className:c,onClick:function(){e.onCardLike(e.card)}}),Object(m.jsx)("div",{className:"card__like-overlay"}),Object(m.jsx)("p",{className:"card__like-count",children:e.card.likes.length})]})]})};var P=function(e){var t=s.a.useContext(U);return Object(m.jsxs)("main",{className:"content",children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsxs)("div",{className:"profile__avatar-container",children:[Object(m.jsx)("img",{src:t.avatar,alt:"portrait of user",className:"profile__avatar"}),Object(m.jsx)("div",{className:"profile__avatar-edit-container",children:Object(m.jsx)("button",{"aria-label":"Edit",type:"button",className:"profile__avatar-edit",onClick:e.onEditAvatar})})]}),Object(m.jsxs)("div",{className:"profile__info",children:[Object(m.jsx)("h1",{className:"profile__name",children:t.name}),Object(m.jsx)("button",{"aria-label":"Edit",type:"button",className:"profile__edit-button",onClick:e.onEditProfile}),Object(m.jsx)("p",{className:"profile__description",children:t.about})]}),Object(m.jsx)("button",{"aria-label":"Add",type:"button",className:"profile__add-button",onClick:e.onAddPlace})]}),Object(m.jsx)("section",{className:"cards",children:e.cards.map((function(t){return Object(m.jsx)(L,{card:t,onCardClick:e.onCardClick,onCardLike:e.handleCardLike,onCardDelete:e.handleCardDelete},t._id)}))})]})};var A=function(){return Object(m.jsx)("footer",{className:"footer",children:Object(m.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Around The U.S."})})};var E=function(e){var t=0!==Object.keys(e.card).length?"modal_opened":"";return Object(m.jsx)("div",{className:"modal modal-figure ".concat(t),children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("figure",{className:"modal__figure",children:[Object(m.jsx)("img",{src:e.card.link,alt:e.card.name,className:"modal__image"}),Object(m.jsx)("figcaption",{className:"modal__image-caption",children:e.card.name})]}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})},T=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(_.a)(this,e),this.baseUrl=n,this.headers=a}return Object(g.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch(this.baseUrl+"/users/me",{method:"GET",headers:this.headers}).then(this._checkResponse)}},{key:"updateUserInfo",value:function(e){var t=e.name,n=e.about;return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:n})}).then(this._checkResponse)}},{key:"updateUserAvatar",value:function(e){return fetch(this.baseUrl+"/users/me/avatar",{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}},{key:"getInitialCards",value:function(){return fetch(this.baseUrl+"/cards",{method:"GET",headers:this.headers}).then(this._checkResponse)}},{key:"getAppInfo",value:function(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}},{key:"postCard",value:function(e){return fetch(this.baseUrl+"/cards",{method:"POST",body:JSON.stringify({name:e.name,link:e.link}),headers:this.headers}).then(this._checkResponse)}},{key:"deleteCard",value:function(e){return fetch(this.baseUrl+"/cards/"+e,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}},{key:"addLike",value:function(e){return fetch(this.baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this.headers}).then(this._checkResponse)}},{key:"removeLike",value:function(e){return fetch(this.baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this.headers}).then(this._checkResponse)}}]),e}())({baseUrl:"http://localhost:3000",headers:{authorization:"1700817e-a1e9-4638-acf5-4cd690372eaf","Content-Type":"application/json"}});var I=function(e){var t="modal modal-".concat(e.name);return t+=e.isOpen?" modal_opened":"",Object(m.jsx)("div",{className:t,children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("form",{className:"form",name:"edit-profile",onSubmit:e.onSubmit,children:[Object(m.jsx)("h2",{className:"form__heading",children:e.title}),e.children,Object(m.jsx)("button",{"aria-label":"Submit",type:"submit",className:"form__save-button",children:"Save"})]}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})};var D=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),i=n[0],c=n[1],o=Object(a.useState)(""),r=Object(l.a)(o,2),d=r[0],u=r[1],h=s.a.useContext(U);return s.a.useEffect((function(){c(h.name||""),u(h.about||"")}),[h]),Object(m.jsxs)(I,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:i,about:d})},title:"Edit profile",name:"edit",children:[Object(m.jsx)("input",{value:i,onChange:function(e){c(e.target.value)},id:"name-input",type:"text",name:"name",className:"form__input form__input_type_name",minLength:"2",maxLength:"40",placeholder:"Name",required:!0}),Object(m.jsx)("span",{id:"name-input-error",className:"form__input-error"}),Object(m.jsx)("input",{value:d,onChange:function(e){u(e.target.value)},id:"description-input",type:"text",name:"about",className:"form__input form__input_type_description",minLength:"2",maxLength:"200",placeholder:"About",required:!0}),Object(m.jsx)("span",{id:"description-input-error",className:"form__input-error"})]})};var R=function(e){var t=Object(a.useRef)("");return Object(m.jsxs)(I,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateUserAvatar(t.current.value),t.current.value=""},title:"Change profile picture",name:"avatar-edit",children:[Object(m.jsx)("input",{ref:t,id:"description-input",type:"url",name:"avatar-url",className:"form__input form__input_type_description",minLength:"2",maxLength:"200",placeholder:"url",required:!0}),Object(m.jsx)("span",{id:"description-input-error",className:"form__input-error"})]})};var q=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),s=n[0],i=n[1],c=Object(a.useState)(""),o=Object(l.a)(c,2),r=o[0],d=o[1];return Object(m.jsxs)(I,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:s,link:r}),i(""),d("")},title:"New place",name:"add",children:[Object(m.jsx)("input",{value:s,onChange:function(e){i(e.target.value)},id:"name-input",type:"text",name:"name",className:"form__input form__input_type_name",minLength:"2",maxLength:"40",placeholder:"Title",required:!0}),Object(m.jsx)("span",{id:"name-input-error",className:"form__input-error"}),Object(m.jsx)("input",{value:r,onChange:function(e){d(e.target.value)},id:"description-input",type:"url",name:"about",className:"form__input form__input_type_description",minLength:"2",maxLength:"200",placeholder:"Image link",required:!0}),Object(m.jsx)("span",{id:"description-input-error",className:"form__input-error"})]})};var M=function(e){var t=e.isOpen?"modal_opened":"";return Object(m.jsx)("div",{className:"modal modal-figure ".concat(t),children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("form",{className:"form form-delete-confirm",name:"delete-confirm",children:[Object(m.jsx)("h2",{className:"form__heading",children:"Are you sure?"}),Object(m.jsx)("button",{"aria-label":"delete-confirm",type:"submit",className:"form__save-button",onClick:function(t){t.preventDefault(),e.handleCardDeleteConfirm()},children:"Yes"})]}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})};var J=function(e){return Object(m.jsx)("div",{className:"modal modal_opened",children:Object(m.jsxs)("div",{className:"modal__container infotooltip",children:[Object(m.jsx)("img",{alt:"error status",src:e.imgSrc,className:"infotooltip__img"}),Object(m.jsx)("h2",{className:"infotooltip__heading",children:e.message}),Object(m.jsx)("button",{"aria-label":"Close",type:"button",className:"modal__close-button",onClick:e.onClose})]})})},z=n.p+"static/media/success.1b6082f8.svg",F=n.p+"static/media/union.7c6a020b.svg";var B=Object(d.i)((function(){var e,t,n=Object(a.useState)({}),s=Object(l.a)(n,2),i=s[0],c=s[1],o=Object(a.useState)(!1),u=Object(l.a)(o,2),h=u[0],b=u[1],p=Object(a.useState)(!1),O=Object(l.a)(p,2),_=O[0],g=O[1],v=Object(a.useState)(!1),x=Object(l.a)(v,2),C=x[0],k=x[1],y=Object(a.useState)({}),L=Object(l.a)(y,2),I=L[0],B=L[1],G=Object(a.useState)({isOpen:!1,id:""}),H=Object(l.a)(G,2),Y=H[0],K=H[1],Q=Object(a.useState)([]),V=Object(l.a)(Q,2),W=V[0],X=V[1],Z=Object(a.useState)(!1),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=Object(d.g)(),ae=Object(a.useState)({registered:!1,showModal:!1}),se=Object(l.a)(ae,2),ie=se[0],ce=se[1];function oe(){k(!1),b(!1),g(!1),K({isOpen:!1,id:null}),B({})}function re(){te(!0)}return Object(a.useEffect)((function(){!function(){var e=localStorage.getItem("token");e&&function(e){return fetch("".concat(w,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(e).then((function(){te(!0)})).then((function(){ne.push("/")}))}()}),[]),Object(a.useEffect)((function(){T.getUserInfo().then((function(e){c(e)})).catch((function(e){console.log(e)}))}),[]),Object(a.useEffect)((function(){T.getInitialCards().then((function(e){X(e)})).catch((function(e){console.log(e)}))}),[]),ie.showModal&&ie.registered?(e="Success! You have now been registered.",t=z):ie.showModal&&(e="Oops, something went wrong! Please try again.",t=F),Object(m.jsx)(U.Provider,{value:i,children:Object(m.jsxs)("div",{className:"page",children:[Object(m.jsx)(f,{handleSignOut:function(){localStorage.removeItem("token"),te(!1),ne.push("/signin")}}),Object(m.jsxs)(d.d,{children:[Object(m.jsxs)(d.b,{path:"/signup",children:[Object(m.jsx)(S,{handleRegister:function(e,t){(function(e,t){return fetch("".concat(w,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){ce(e?{registered:!0,showModal:!0}:{showModal:!0})}))}}),ie.showModal&&Object(m.jsx)(J,{onClose:function(){ie.showModal&&ie.registered?(ce({showModal:!1}),ne.push("/signin")):ce({showModal:!1})},message:e,imgSrc:t})]}),Object(m.jsx)(d.b,{path:"/signin",children:Object(m.jsx)(N,{handleLogin:re,handleAuthorize:function(e,t){(function(e,t){return fetch("".concat(w,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("token",e.token),e})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){e.token&&(re(),ne.push("/"))})).catch((function(e){return console.log(e)}))}})}),Object(m.jsx)(j,{path:"/",loggedIn:ee,onEditProfile:function(){b(!0)},onAddPlace:function(){g(!0)},onEditAvatar:function(){k(!0)},onCardClick:function(e){var t=e.name,n=e.link;B({name:t,link:n})},cards:W,handleCardLike:function(e){e.likes.some((function(e){return e._id===i._id}))?T.removeLike(e._id).then((function(e){X(W.map((function(t){return t._id===e._id?e:t})))})).catch((function(e){console.log(e)})):T.addLike(e._id).then((function(e){X(W.map((function(t){return t._id===e._id?e:t})))})).catch((function(e){console.log(e)}))},handleCardDelete:function(e){K({isOpen:!0,id:e._id})},component:P})]}),Object(m.jsx)(A,{}),Object(m.jsx)(D,{isOpen:h,onClose:oe,onUpdateUser:function(e){var t=e.name,n=e.about;T.updateUserInfo({name:t,about:n}).then((function(e){c(e),oe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(R,{isOpen:C,onClose:oe,onUpdateUserAvatar:function(e){T.updateUserAvatar(e).then((function(e){c(e),oe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(q,{isOpen:_,onClose:oe,onAddPlace:function(e){T.postCard(e).then((function(e){X([e].concat(Object(r.a)(W))),oe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(E,{card:I,onClose:oe}),Object(m.jsx)(M,{isOpen:Y.isOpen,onClose:oe,handleCardDeleteConfirm:function(){Y.isOpen&&Y.id&&T.deleteCard(Y.id).then((function(){X(W.filter((function(e){return e._id!==Y.id}))),oe()})).catch((function(e){console.log(e)}))}})]})})})),G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,43)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),i(e),c(e)}))};c.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(o.a,{children:Object(m.jsx)(B,{})})}),document.getElementById("root")),G()}},[[42,1,2]]]);
//# sourceMappingURL=main.db7e90a5.chunk.js.map